:root {
    --bg: #0b1020;
    --panel: #121a33;
    --text: #e8f0ff;
    --muted: #90a0c0;
    --primary: #6aa9ff;
    --accent: #ffd54a;
    --danger: #ff5861;
    --success: #4ade80;
    --canvas-shadow: 0 10px 30px rgba(0,0,0,0.35);
}

* { box-sizing: border-box; }
html, body { height: 100%; }
body {
    margin: 0;
    color: var(--text);
    background: radial-gradient(1200px 600px at 20% -10%, rgba(106,169,255,0.2), rgba(0,0,0,0)) ,
                linear-gradient(180deg, #0b0f1a 0%, #0c1327 50%, #0b1020 100%);
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Noto Sans KR", Arial, sans-serif;
    -webkit-user-select: none; /* iOS long-press 선택 방지 */
    -ms-user-select: none;
    user-select: none;
    -webkit-touch-callout: none; /* iOS 복사/공유 메뉴 방지 */
}

.app {
    min-height: 100dvh;
    display: grid;
    grid-template-rows: auto 1fr auto;
    gap: 12px;
    padding: 12px 12px 20px;
}

.topbar, .bottombar {
    display: grid;
    grid-template-columns: 1fr auto 1fr;
    align-items: center;
    gap: 12px;
}
.hud-left { justify-self: start; }
.hud-right { justify-self: end; }

.battery { display: inline-flex; align-items: center; gap: 8px; color: var(--muted); }
.battery-icon { width: 54px; height: 24px; display: block; }
.battery-outline { fill: none; stroke: #9fb7ff; stroke-width: 2; opacity: 0.9; }
.battery-nub { fill: #9fb7ff; opacity: 0.9; }
.battery-fill-bg { fill: rgba(159,183,255,0.15); }
.battery-fill { fill: #7cf; }
.battery-text { font-weight: 600; color: var(--text); font-variant-numeric: tabular-nums; }

.score { font-weight: 700; color: var(--accent); text-shadow: 0 1px 0 rgba(0,0,0,0.4); }

.stage {
    display: grid;
    place-items: center;
}
.canvas-wrap {
    position: relative;
    width: min(800px, 95vw);
    aspect-ratio: 800 / 500;
    border-radius: 14px;
    overflow: hidden;
    box-shadow: var(--canvas-shadow);
    background: #0a0f1d;
    border: 2px solid rgba(124, 200, 255, 0.25);
    touch-action: none; /* 제스처 입력 우선, 스크롤/줌 제스처 방지 */
}
.canvas-wrap.danger {
    animation: dangerPulse 0.5s steps(2, end) infinite;
}
@keyframes dangerPulse {
    0% { box-shadow: 0 0 0 0 rgba(255,88,97,0.65), var(--canvas-shadow); border-color: rgba(255,88,97,0.8); }
    100% { box-shadow: 0 0 12px 6px rgba(255,88,97,0), var(--canvas-shadow); border-color: rgba(255,88,97,0.3); }
}

canvas { width: 100%; height: 100%; display: block; image-rendering: pixelated; }

.cheer {
    position: absolute;
    left: 50%; top: 10px;
    transform: translateX(-50%);
    background: rgba(0,0,0,0.45);
    color: #fff;
    padding: 8px 12px;
    border-radius: 10px;
    font-weight: 700;
    backdrop-filter: blur(6px);
    opacity: 0; pointer-events: none;
    transition: opacity 160ms ease;
}
.cheer.show { opacity: 1; }

.bottombar { gap: 10px; }
.controls-left, .controls-right { display: flex; gap: 8px; align-items: center; }
.controls-center { display: flex; gap: 12px; justify-content: center; align-items: center; }

.btn {
    background: #1b264a;
    color: var(--text);
    border: 1px solid rgba(255,255,255,0.08);
    padding: 8px 12px;
    border-radius: 10px;
    cursor: pointer;
    font-weight: 700;
}
.btn:hover { filter: brightness(1.08); }
.btn:active { transform: translateY(1px); }
.btn.primary { background: linear-gradient(180deg, #6aa9ff, #4b84f7); color: #061022; border: none; }
.btn.primary.lg { padding: 12px 16px; font-size: 1.05rem; }
.btn.icon { font-size: 18px; line-height: 1; }

.touch-controls .touch-btn {
    background: rgba(255,255,255,0.08);
    border: 1px solid rgba(255,255,255,0.15);
    color: var(--text);
    font-size: 22px;
    width: 64px; height: 64px;
    border-radius: 14px;
    backdrop-filter: blur(6px);
}

.overlay {
    position: fixed;
    inset: 0;
    display: grid;
    place-items: center;
    background: rgba(0,0,0,0.45);
    backdrop-filter: blur(6px);
    z-index: 10;
    -webkit-user-select: none; user-select: none; -webkit-touch-callout: none;
}
.overlay[hidden] { display: none; }
.panel {
    width: min(560px, 92vw);
    background: var(--panel);
    border: 1px solid rgba(255,255,255,0.08);
    border-radius: 16px;
    padding: 16px 18px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.4);
}
.panel h2 { margin: 0 0 8px; }
.panel .desc { margin: 10px 0 14px; color: var(--muted); padding-left: 18px; }
.panel .stats { display: grid; gap: 6px; margin: 8px 0 12px; }
.badge { background: var(--accent); color: #1a1300; padding: 2px 6px; border-radius: 8px; font-weight: 900; margin-left: 8px; }
.share { display: flex; gap: 8px; }
.share-line { color: var(--muted); }

.toast {
    position: fixed;
    left: 50%; bottom: 16px;
    transform: translateX(-50%);
    background: rgba(0,0,0,0.7);
    color: #fff;
    padding: 10px 14px;
    border-radius: 12px;
    font-weight: 700;
    opacity: 0; pointer-events: none;
    transition: opacity 150ms ease;
    z-index: 20;
}
.toast.show { opacity: 1; }

/* 터치 장치에서 자동 노출 */
@media (pointer: coarse) {
    #touchControls[hidden] { display: flex !important; }
    .touch-controls .touch-btn { width: 84px; height: 84px; font-size: 26px; }
}



